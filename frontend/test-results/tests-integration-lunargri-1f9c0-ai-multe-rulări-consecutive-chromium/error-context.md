# Test info

- Name: LunarGrid Integrare CompletÄƒ cu Date Dinamice >> testeazÄƒ varietatea Ã®n mai multe rulÄƒri consecutive
- Location: C:\CursorRepos\zd\frontend\tests\e2e\tests\integration\lunargrid-integration.spec.ts:89:7

# Error details

```
Error: expect(received).toBe(expected) // Object.is equality

Expected: 5
Received: 4
    at C:\CursorRepos\zd\frontend\tests\e2e\tests\integration\lunargrid-integration.spec.ts:121:31
```

# Page snapshot

```yaml
- status: Autentificare reuÈ™itÄƒ! Bine ai revenit.
- link "TranzacÈ›ii":
  - /url: /transactions
- link "Grid Lunar":
  - /url: /lunar-grid
- link "Enhanced LunarGrid (Phase 4)":
  - /url: /enhanced-lunar-grid
- link "ğŸš€ LunarGrid Enhanced (Modal Architecture)":
  - /url: /lunar-grid-enhanced
- link "OpÈ›iuni":
  - /url: /options
- heading "Grid Lunar" [level=1]
- combobox:
  - option "Ianuarie"
  - option "Februarie"
  - option "Martie"
  - option "Aprilie"
  - option "Mai" [selected]
  - option "Iunie"
  - option "Iulie"
  - option "August"
  - option "Septembrie"
  - option "Octombrie"
  - option "Noiembrie"
  - option "Decembrie"
- spinbutton: "2025"
- button "Extinde tot"
- button "ReseteazÄƒ"
- table:
  - rowgroup:
    - row "Categorii 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 Total":
      - cell "Categorii"
      - cell "1"
      - cell "2"
      - cell "3"
      - cell "4"
      - cell "5"
      - cell "6"
      - cell "7"
      - cell "8"
      - cell "9"
      - cell "10"
      - cell "11"
      - cell "12"
      - cell "13"
      - cell "14"
      - cell "15"
      - cell "16"
      - cell "17"
      - cell "18"
      - cell "19"
      - cell "20"
      - cell "21"
      - cell "22"
      - cell "23"
      - cell "24"
      - cell "25"
      - cell "26"
      - cell "27"
      - cell "28"
      - cell "29"
      - cell "30"
      - cell "31"
      - cell "Total"
  - rowgroup:
    - row "â–¶ VENITURI 3.769,00 347.720,00 896,00 565.811,00 2.512,00 2.123.212,00 2.690,00 14.803,00 192,00 34.050,25 976,75 38,75 23,00 â€” 3.123,00 â€” 178,00 123,00 22,00 â€” â€” 21,50 â€” 3.332,00 213,00 123.123.123.123,00 â€” â€” 9.064,00 123.127.953,00 â€” 123.249.363.846,26":
      - cell "â–¶ VENITURI"
      - cell "3.769,00"
      - cell "347.720,00"
      - cell "896,00"
      - cell "565.811,00"
      - cell "2.512,00"
      - cell "2.123.212,00"
      - cell "2.690,00"
      - cell "14.803,00"
      - cell "192,00"
      - cell "34.050,25"
      - cell "976,75"
      - cell "38,75"
      - cell "23,00"
      - cell "â€”"
      - cell "3.123,00"
      - cell "â€”"
      - cell "178,00"
      - cell "123,00"
      - cell "22,00"
      - cell "â€”"
      - cell "â€”"
      - cell "21,50"
      - cell "â€”"
      - cell "3.332,00"
      - cell "213,00"
      - cell "123.123.123.123,00"
      - cell "â€”"
      - cell "â€”"
      - cell "9.064,00"
      - cell "123.127.953,00"
      - cell "â€”"
      - cell "123.249.363.846,26"
    - row "â–¶ ECONOMII 23,00 123,00 32,00 1.796,25 â€” 22,00 â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” 555,00 6.786,00 1.356.110,00 â€” 1.365.447,25":
      - cell "â–¶ ECONOMII"
      - cell "23,00"
      - cell "123,00"
      - cell "32,00"
      - cell "1.796,25"
      - cell "â€”"
      - cell "22,00"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "555,00"
      - cell "6.786,00"
      - cell "1.356.110,00"
      - cell "â€”"
      - cell "1.365.447,25"
    - row "â–¶ INFATISARE 8.989,00 â€” â€” â€” â€” â€” â€” â€” â€” â€” 1.231,00 1.231.116.912,00 12.312.312,00 123,00 392,00 123.551.231,00 â€” â€” â€” â€” â€” â€” 131,00 â€” 23,00 â€” â€” 32,00 32,00 12,00 â€” 1.366.991.420,00":
      - cell "â–¶ INFATISARE"
      - cell "8.989,00"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "1.231,00"
      - cell "1.231.116.912,00"
      - cell "12.312.312,00"
      - cell "123,00"
      - cell "392,00"
      - cell "123.551.231,00"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "131,00"
      - cell "â€”"
      - cell "23,00"
      - cell "â€”"
      - cell "â€”"
      - cell "32,00"
      - cell "32,00"
      - cell "12,00"
      - cell "â€”"
      - cell "1.366.991.420,00"
    - row "â–¶ EDUCATIE â€” â€” 344,00 â€” â€” â€” â€” â€” 123,00 33,00 â€” 1.231.115.392,00 999.999,00 â€” â€” 9.999,00 â€” 123,00 â€” 7.777,00 â€” â€” â€” 312.312,00 â€” â€” 12.355.512.312,00 â€” 156,00 5.652,00 565,00 13.587.964.787,00":
      - cell "â–¶ EDUCATIE"
      - cell "â€”"
      - cell "â€”"
      - cell "344,00"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "123,00"
      - cell "33,00"
      - cell "â€”"
      - cell "1.231.115.392,00"
      - cell "999.999,00"
      - cell "â€”"
      - cell "â€”"
      - cell "9.999,00"
      - cell "â€”"
      - cell "123,00"
      - cell "â€”"
      - cell "7.777,00"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "312.312,00"
      - cell "â€”"
      - cell "â€”"
      - cell "12.355.512.312,00"
      - cell "â€”"
      - cell "156,00"
      - cell "5.652,00"
      - cell "565,00"
      - cell "13.587.964.787,00"
    - row "â–¶ CARIERA â€” â€” â€” â€” â€” â€” â€” â€” 1.234,25 â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” 123,00 â€” 1.357,25":
      - cell "â–¶ CARIERA"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "1.234,25"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "123,00"
      - cell "â€”"
      - cell "1.357,25"
    - row "â–¶ SANATATE â€” â€” 33,00 â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” 33,00":
      - cell "â–¶ SANATATE"
      - cell "â€”"
      - cell "â€”"
      - cell "33,00"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "33,00"
    - row "â–¶ NUTRITIE â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” 23,00 â€” â€” â€” â€” â€” 23,00":
      - cell "â–¶ NUTRITIE"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "23,00"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "23,00"
    - row "â–¶ LOCUINTA â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” 601,63 â€” â€” â€” â€” â€” 601,63":
      - cell "â–¶ LOCUINTA"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "601,63"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "601,63"
    - row "â–¶ TIMP_LIBER â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” 678,00 â€” 678,00":
      - cell "â–¶ TIMP_LIBER"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "678,00"
      - cell "â€”"
      - cell "678,00"
    - row "â–¶ CALATORII â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€”":
      - cell "â–¶ CALATORII"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
    - row "â–¶ TRANSPORT â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€”":
      - cell "â–¶ TRANSPORT"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
    - row "â–¶ INVESTITII â€” â€” 1.151,25 â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” 1.151,25":
      - cell "â–¶ INVESTITII"
      - cell "â€”"
      - cell "â€”"
      - cell "1.151,25"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "1.151,25"
    - row "â–¶ TEST â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€”":
      - cell "â–¶ TEST"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
      - cell "â€”"
    - row "Sold - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 0,00":
      - cell "Sold"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "-"
      - cell "0,00"
```

# Test source

```ts
   21 |       totalAÈ™teptat: gridData.expectedTotal
   22 |     });
   23 |     
   24 |     // Login
   25 |     await authPage.loginWithPrimaryAccount();
   26 |     
   27 |     // NavigheazÄƒ la LunarGrid
   28 |     await page.getByTestId('lunar-grid-tab').click();
   29 |     await page.waitForLoadState('networkidle');
   30 |     console.log('âœ… Navigat la LunarGrid');
   31 |     
   32 |     // VerificÄƒ existenÈ›a grid-ului
   33 |     const gridContainer = page.getByTestId('lunar-grid-container');
   34 |     await expect(gridContainer).toBeVisible();
   35 |     
   36 |     // ObÈ›ine workflow-ul LunarGrid
   37 |     const workflow = LunarGridTestData.getLunarGridWorkflow();
   38 |     
   39 |     // Pasul 1: ExpandeazÄƒ toate categoriile
   40 |     const toggleExpandButton = page.getByTestId(workflow.STEP_TOGGLE_EXPAND_ALL);
   41 |     await expect(toggleExpandButton).toBeVisible();
   42 |     await toggleExpandButton.click();
   43 |     await page.waitForTimeout(workflow.WAIT_FOR_EXPANSION);
   44 |     console.log('âœ… Expandat toate categoriile');
   45 |     
   46 |     // VerificÄƒ cÄƒ s-au expandat celule
   47 |     const expandedCells = page.locator('[data-testid*="editable-cell"]');
   48 |     const cellCount = await expandedCells.count();
   49 |     expect(cellCount).toBeGreaterThan(1000); // Mult mai multe celule dupÄƒ expandare
   50 |     console.log(`âœ… ${cellCount} celule expandate gÄƒsite`);
   51 |     
   52 |     // Pasul 2: TesteazÄƒ celula primarÄƒ
   53 |     const primarySelectors = LunarGridTestData.getDynamicSelectors(gridData.primaryCombo, 15);
   54 |     const primaryCell = page.getByTestId(primarySelectors.cellSelector);
   55 |     await expect(primaryCell).toBeVisible();
   56 |     console.log(`âœ… Celula primarÄƒ gÄƒsitÄƒ: ${primarySelectors.cellSelector}`);
   57 |     
   58 |     // Pasul 3: TesteazÄƒ celula secundarÄƒ
   59 |     const secondarySelectors = LunarGridTestData.getDynamicSelectors(gridData.secondaryCombo, 15);
   60 |     const secondaryCell = page.getByTestId(secondarySelectors.cellSelector);
   61 |     await expect(secondaryCell).toBeVisible();
   62 |     console.log(`âœ… Celula secundarÄƒ gÄƒsitÄƒ: ${secondarySelectors.cellSelector}`);
   63 |     
   64 |     // Pasul 4: Test click pe celule (simulare editare)
   65 |     await primaryCell.click();
   66 |     console.log('âœ… Click realizat pe celula primarÄƒ');
   67 |     
   68 |     await secondaryCell.click();
   69 |     console.log('âœ… Click realizat pe celula secundarÄƒ');
   70 |     
   71 |     // Pasul 5: Test collapse cu reset
   72 |     const resetButton = page.getByTestId(workflow.STEP_RESET_EXPANDED);
   73 |     await expect(resetButton).toBeVisible();
   74 |     await resetButton.click();
   75 |     await page.waitForTimeout(1000);
   76 |     console.log('âœ… Reset expandare realizat');
   77 |     
   78 |     // VerificÄƒ cÄƒ s-au redus celulele dupÄƒ reset
   79 |     const cellsAfterReset = page.locator('[data-testid*="editable-cell"]');
   80 |     const cellCountAfterReset = await cellsAfterReset.count();
   81 |     expect(cellCountAfterReset).toBeLessThan(cellCount);
   82 |     console.log(`âœ… Celule dupÄƒ reset: ${cellCountAfterReset} (reduse faÈ›Äƒ de ${cellCount})`);
   83 |     
   84 |     // Screenshot final
   85 |     await page.screenshot({ path: 'test-results/lunargrid-integration-complete.png', fullPage: true });
   86 |     console.log('âœ… Screenshot salvat: lunargrid-integration-complete.png');
   87 |   });
   88 |
   89 |   test('testeazÄƒ varietatea Ã®n mai multe rulÄƒri consecutive', async ({ page }) => {
   90 |     console.log('ğŸ¯ Test varietate pentru rulÄƒri consecutive');
   91 |     
   92 |     // Login o singurÄƒ datÄƒ
   93 |     await authPage.loginWithPrimaryAccount();
   94 |     await page.getByTestId('lunar-grid-tab').click();
   95 |     await page.waitForLoadState('networkidle');
   96 |     
   97 |     // ExpandeazÄƒ grid-ul
   98 |     await page.getByTestId('toggle-expand-all').click();
   99 |     await page.waitForTimeout(2000);
  100 |     
  101 |     // GenereazÄƒ È™i testeazÄƒ 5 combinaÈ›ii diferite
  102 |     const testedCombos: string[] = [];
  103 |     for (let i = 1; i <= 5; i++) {
  104 |       const combo = TestDataGenerator.getNextCombo();
  105 |       testedCombos.push(`${combo.categoryKey}-${combo.subcategory}`);
  106 |       
  107 |       const selectors = LunarGridTestData.getDynamicSelectors(combo, 10 + i);
  108 |       const cell = page.getByTestId(selectors.cellSelector);
  109 |       const exists = await cell.isVisible().catch(() => false);
  110 |       
  111 |       console.log(`${i}. ${combo.transactionType} | ${combo.categoryKey} â†’ ${combo.subcategory} | Celula existÄƒ: ${exists}`);
  112 |       
  113 |       if (exists) {
  114 |         await cell.click(); // Test interacÈ›iune
  115 |         await page.waitForTimeout(100);
  116 |       }
  117 |     }
  118 |     
  119 |     // VerificÄƒ cÄƒ sunt toate diferite
  120 |     const uniqueCombos = new Set(testedCombos);
> 121 |     expect(uniqueCombos.size).toBe(testedCombos.length);
      |                               ^ Error: expect(received).toBe(expected) // Object.is equality
  122 |     console.log('âœ… Toate combinaÈ›iile sunt unice');
  123 |     
  124 |     // AfiÈ™eazÄƒ statistici finale
  125 |     const stats = TestDataGenerator.getStats();
  126 |     console.log('ğŸ“Š Statistici finale:', {
  127 |       totalEstimate: stats.totalCombinations,
  128 |       folosite: stats.usedCombinations,
  129 |       rÄƒmase: stats.remainingCombinations
  130 |     });
  131 |   });
  132 | }); 
```